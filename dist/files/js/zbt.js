function updateHeadersVisibility(){document.querySelectorAll(".zbt__head").forEach((e=>{e.classList.remove("_visible")}));if(document.querySelector(".zbt-inventories._active")){const e=document.querySelector('.zbt__head._path[data-screen="zbt-path"]');e&&e.classList.add("_visible")}else{const e=document.querySelector("[data-screen]._visible");if(e){const t=e.getAttribute("data-screen"),s=document.querySelector(`.zbt__head[data-screen="${t}"]`);s&&s.classList.add("_visible")}}}document.addEventListener("DOMContentLoaded",(()=>{const e={treasureButton:document.querySelector(".treasure-widget"),treasureButtonMobile:document.querySelector(".treasure-widget__button"),treasureImage:document.querySelector(".treasure-widget__image"),header:document.getElementById("header"),hero:document.getElementById("hero"),zbtElement:document.querySelector(".zbt-class"),zbtHead:document.querySelector('[data-screen="zbt-class"]'),buttonBack:document.querySelector("._back-to-main-screen"),zbtBg:document.querySelector(".zbt-bg")},t=t=>{const s=t?"add":"remove";e.header?.classList[s]("_hidden"),e.hero?.classList[s]("_hidden");"choose-class"===e.treasureButton?.getAttribute("trasure-toggle")&&(e.zbtElement?.classList[s]("_visible"),e.zbtHead?.classList[s]("_visible"),e.zbtBg?.classList[s]("_visible"))};window.innerWidth<768?[e.treasureButtonMobile,e.treasureImage].forEach((e=>{e?.addEventListener("click",(()=>t(!0)))})):e.treasureButton?.addEventListener("click",(()=>t(!0))),e.buttonBack?.addEventListener("click",(()=>t(!1)))})),document.addEventListener("click",(e=>{const t=e.target.closest("[data-toggle-screen]");if(!t)return;const s=t.getAttribute("data-toggle-screen");if(document.querySelectorAll("[data-screen]").forEach((e=>{const t=e.getAttribute("data-screen").split(/\s+/);e.classList.toggle("_visible",t.includes(s))})),t.classList.contains("zbt__back-btn")){document.querySelectorAll(".zbt-path, .zbt-inventories, .zbt-inventory").forEach((e=>{e.classList.remove("_active")})),updateHeadersVisibility();document.querySelectorAll(".carouselContainer").forEach((e=>{const t=e.closest(".carouselWrapper");if(!t)return;const s=parseInt(e.dataset.carouselstartwidth)||0;if(t.offsetWidth<s||0===s)e.setAttribute("data-carousel-active","true"),e.classList.add("carousel-active");else{e.setAttribute("data-carousel-active","false"),e.classList.remove("carousel-active");e.querySelectorAll(".tilted-card").forEach((e=>{e.style.transform="",e.style.zIndex=""}))}}))}})),document.addEventListener("click",(e=>{e.target.closest("[data-artefacts-screen]")&&updateHeadersVisibility()}));const observer=new MutationObserver((e=>{e.forEach((e=>{e.target.classList.contains("zbt-inventories")&&updateHeadersVisibility()}))}));document.querySelectorAll(".zbt-inventories").forEach((e=>{observer.observe(e,{attributes:!0,attributeFilter:["class"]})}));const settings={scaleOnHover:1.05,rotateAmplitude:5};class TiltedCard{constructor(e){this.element=e,this.inner=e.querySelector(".tilted-card__wrapper"),this.img=e.querySelector(".tilted-card__img"),this.overlay=e.querySelector(".tilted-card__overlay"),this.currentX=0,this.currentY=0,this.init()}init(){this.inner.style.transformStyle="preserve-3d",this.element.addEventListener("mousemove",this.handleMouse.bind(this)),this.element.addEventListener("mouseenter",this.handleMouseEnter.bind(this)),this.element.addEventListener("mouseleave",this.handleMouseLeave.bind(this))}handleMouse(e){const t=this.element.getBoundingClientRect(),s=e.clientX-t.left-t.width/2,n=(e.clientY-t.top-t.height/2)/(t.height/2)*-settings.rotateAmplitude,a=s/(t.width/2)*settings.rotateAmplitude;Motion.animate(this.inner,{rotateX:`${n}deg`,rotateY:`${a}deg`},{duration:.15,easing:"easeOut"}),this.currentX=e.clientX-t.left,this.currentY=e.clientY-t.top}handleMouseEnter(){Motion.animate(this.inner,{scale:settings.scaleOnHover},{duration:.2,easing:[.23,1,.32,1]})}handleMouseLeave(){Motion.animate(this.inner,{scale:1,rotateX:"0deg",rotateY:"0deg"},{duration:.3,easing:[.23,1,.32,1]})}}const initCards=()=>{document.querySelectorAll(".tilted-card").forEach((e=>new TiltedCard(e)))};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",initCards):initCards(),document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelectorAll(".carouselContainer");function t(){e.forEach((e=>{const t=e.closest(".carouselWrapper");if(!t)return;if(!t._resizeObserverInitialized){new ResizeObserver((()=>{const s=t.offsetWidth;if((parseInt(e.dataset.carouselstartwidth)||0)>s)e.setAttribute("data-carousel-active","true"),e.classList.add("carousel-active"),f();else{e.setAttribute("data-carousel-active","false"),e.classList.remove("carousel-active");e.querySelectorAll(".tilted-card").forEach((e=>{e.style.transform="",e.style.zIndex=""}))}})).observe(t),t._resizeObserverInitialized=!0}const s=parseInt(e.dataset.carouselstartwidth)||0;t.offsetWidth;let n=0,a=null,o=null,r=!1;const c=e.querySelectorAll(".tilted-card"),i=c.length;let d=0,l=0;e.addEventListener("touchstart",(function(e){d=e.changedTouches[0].screenX}),!1),e.addEventListener("touchend",(function(e){l=e.changedTouches[0].screenX,h()}),!1),e.addEventListener("mousedown",(function(e){e.preventDefault(),d=e.screenX,document.addEventListener("mousemove",v),document.addEventListener("mouseup",m)}));let u=0;function v(t){u=t.screenX;const s=u-d,n=e.querySelector(".tilted-card.active");n&&Motion.animate(n,{x:s/5},{duration:0})}function m(t){l=t.screenX,document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",m);const s=e.querySelector(".tilted-card.active");s&&Motion.animate(s,{x:0},{duration:.2}),h()}function h(){l-d>50?(r=!1,b((n-1+i)%i),a="prev"):d-l>50&&(r=!1,b((n+1)%i),a="next")}function b(e){n=e,f()}function f(){c.forEach(((e,t)=>{const s=function(e){const t=(e-n+i)%i;return 0===t?{x:0,y:0,scale:1.15,zIndex:10}:1===t?{x:270-50*t,y:0,scale:1,zIndex:6}:2===t?{x:500-50*t,y:0,scale:.85,zIndex:5}:{x:-220,y:0,scale:1,zIndex:"prev"===a||o===n?4:6}}(t);t===n?e.classList.add("active"):e.classList.remove("active"),Motion.animate(e,{x:s.x,y:s.y,scale:s.scale,zIndex:s.zIndex},{duration:1.3,easing:"ease-out",type:"spring",bounce:.2})}))}c.forEach(((a,i)=>{a.addEventListener("click",(d=>{d.stopPropagation();const l=a.closest(".zbt-path");l&&(document.querySelectorAll(".zbt-path").forEach((e=>{e.classList.remove("_active")})),l.classList.add("_active"));const u=a.getAttribute("data-artefacts-screen");if(u){const e=l.querySelector(`[data-artefacts="${u}"]`);e&&(l.querySelectorAll(".zbt-inventory").forEach((e=>{e.classList.remove("_active")})),e.classList.add("_active"));const t=l.querySelector(".zbt-inventories");t&&t.classList.add("_active")}t.offsetWidth<s||0===s?(e.setAttribute("data-carousel-active","true"),e.classList.add("carousel-active"),n=i,o=i,r=!0,c.forEach((e=>e.classList.remove("active"))),a.classList.add("active"),f()):(c.forEach((e=>e.classList.remove("active"))),a.classList.add("active"))}))}))}))}t(),window.addEventListener("resize",t)})),document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelectorAll(".artifact");0!==e.length&&e.forEach((function(e){const t=e.querySelector(".artifact__tooltip");function s(){t.classList.add("_active");e.getBoundingClientRect().top<350?(t.classList.add("_bottom"),t.classList.remove("_top")):(t.classList.add("_top"),t.classList.remove("_bottom")),requestAnimationFrame((()=>{t.getBoundingClientRect().right-window.innerWidth>20?t.classList.add("_left"):t.classList.remove("_left")}))}function n(){t.classList.remove("_active","_top","_bottom","_left")}t&&(e.addEventListener("mouseenter",s),e.addEventListener("mouseleave",n),e.addEventListener("touchstart",(function(e){e.preventDefault(),s()})),document.addEventListener("touchstart",(function(t){e.contains(t.target)||n()})))}))})),document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelector(".zbt-bg");function t(){const e=document.querySelector(".zbt-bg__background-video"),t=document.querySelector(".zbt-bg__background-image");if(e&&t){const s=e.offsetHeight;t.style.maskPosition=`center ${s}px`}}function s(){e.classList.toggle("_bg-chandged")}t(),window.addEventListener("resize",t);[...document.querySelectorAll(".zbt-class__hidden-zone-btn"),...document.querySelectorAll(".zbt-class__item-btn"),...document.querySelectorAll('[data-toggle-screen="zbt-class"]')].forEach((e=>{e.addEventListener("click",s)}))})),document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelectorAll("[open-zbt-popup]"),t=document.querySelectorAll(".zbt-popup");function s(e){const t=e.getAttribute("data-zbt-close-link");t?window.location.href=t:e.classList.remove("_visible")}e.forEach((e=>{e.addEventListener("click",(function(){const e=this.getAttribute("open-zbt-popup");t.forEach((e=>{e.classList.remove("_visible")}));const s=document.querySelector(`.zbt-popup[data-zbt-popup="${e}"]`);s&&s.classList.add("_visible")}))}));document.querySelectorAll(".zbt-popup__close").forEach((e=>{e.addEventListener("click",(function(){const e=this.closest(".zbt-popup");e&&s(e)}))})),t.forEach((e=>{e.addEventListener("click",(function(e){e.target.closest(".zbt-popup__wrapper")||s(this)}))}))}));