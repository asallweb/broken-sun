document.addEventListener("DOMContentLoaded",(()=>{const e={treasureButton:document.querySelector(".treasure-widget__button"),header:document.getElementById("header"),hero:document.getElementById("hero"),zbtElement:document.querySelector(".zbt-class"),zbtHead:document.querySelector('[data-screen="zbt-class"]'),buttonBack:document.querySelector("._back-to-main-screen")};e.treasureButton?.addEventListener("click",(()=>{e.header?.classList.add("_hidden"),e.hero?.classList.add("_hidden"),e.zbtElement?.classList.add("_visible"),e.zbtHead?.classList.add("_visible")})),e.buttonBack?.addEventListener("click",(()=>{e.header?.classList.remove("_hidden"),e.hero?.classList.remove("_hidden"),e.zbtElement?.classList.remove("_visible"),e.zbtHead?.classList.remove("_visible")}))})),document.addEventListener("click",(e=>{const t=e.target.closest("[data-toggle-screen]");if(!t)return;const s=t.getAttribute("data-toggle-screen");if(document.querySelectorAll("[data-screen]").forEach((e=>{const t=e.getAttribute("data-screen").split(/\s+/);e.classList.toggle("_visible",t.includes(s))})),t.classList.contains("zbt__back-btn")){document.querySelectorAll(".zbt-path, .zbt-inventories, .zbt-inventory").forEach((e=>{e.classList.remove("_active")}));document.querySelectorAll(".carouselContainer").forEach((e=>{const t=e.closest(".carouselWrapper");if(!t)return;const s=parseInt(e.dataset.carouselstartwidth)||0;if(t.offsetWidth<s||0===s)e.setAttribute("data-carousel-active","true"),e.classList.add("carousel-active");else{e.setAttribute("data-carousel-active","false"),e.classList.remove("carousel-active");e.querySelectorAll(".tilted-card").forEach((e=>{e.style.transform="",e.style.zIndex=""}))}}))}}));const settings={scaleOnHover:1.05,rotateAmplitude:5};class TiltedCard{constructor(e){this.element=e,this.inner=e.querySelector(".tilted-card__inner"),this.img=e.querySelector(".tilted-card__img"),this.overlay=e.querySelector(".tilted-card__overlay"),this.currentX=0,this.currentY=0,this.init()}init(){this.inner.style.transformStyle="preserve-3d",this.element.addEventListener("mousemove",this.handleMouse.bind(this)),this.element.addEventListener("mouseenter",this.handleMouseEnter.bind(this)),this.element.addEventListener("mouseleave",this.handleMouseLeave.bind(this))}handleMouse(e){const t=this.element.getBoundingClientRect(),s=e.clientX-t.left-t.width/2,n=(e.clientY-t.top-t.height/2)/(t.height/2)*-settings.rotateAmplitude,a=s/(t.width/2)*settings.rotateAmplitude;Motion.animate(this.inner,{rotateX:`${n}deg`,rotateY:`${a}deg`},{duration:.15,easing:"easeOut"}),this.currentX=e.clientX-t.left,this.currentY=e.clientY-t.top}handleMouseEnter(){Motion.animate(this.inner,{scale:settings.scaleOnHover},{duration:.2,easing:[.23,1,.32,1]})}handleMouseLeave(){Motion.animate(this.inner,{scale:1,rotateX:"0deg",rotateY:"0deg"},{duration:.3,easing:[.23,1,.32,1]})}}const initCards=()=>{document.querySelectorAll(".tilted-card").forEach((e=>new TiltedCard(e)))};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",initCards):initCards(),document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelectorAll(".carouselContainer");function t(){e.forEach((e=>{const t=e.closest(".carouselWrapper");if(!t)return;if(!t._resizeObserverInitialized){new ResizeObserver((()=>{const s=t.offsetWidth;if((parseInt(e.dataset.carouselstartwidth)||0)>s)e.setAttribute("data-carousel-active","true"),e.classList.add("carousel-active"),l();else{e.setAttribute("data-carousel-active","false"),e.classList.remove("carousel-active");e.querySelectorAll(".tilted-card").forEach((e=>{e.style.transform="",e.style.zIndex=""}))}})).observe(t),t._resizeObserverInitialized=!0}const s=parseInt(e.dataset.carouselstartwidth)||0;t.offsetWidth;let n=0,a=null,i=null,r=!1;const o=e.querySelectorAll(".tilted-card"),c=o.length;function d(e){n=e,l()}function l(){o.forEach(((e,t)=>{const s=function(e){const t=(e-n+c)%c;return 0===t?{x:0,y:0,scale:1.15,zIndex:10}:1===t?{x:270-50*t,y:0,scale:1,zIndex:6}:2===t?{x:500-50*t,y:0,scale:.85,zIndex:5}:{x:-220,y:0,scale:1,zIndex:"prev"===a||i===n?4:6}}(t);t===n?e.classList.add("active"):e.classList.remove("active"),Motion.animate(e,{x:s.x,y:s.y,scale:s.scale,zIndex:s.zIndex},{duration:.5,easing:"ease-out",type:"spring",bounce:.25})}))}o.forEach(((u,v)=>{u.addEventListener("click",(m=>{m.stopPropagation();const h=u.closest(".zbt-path");h&&(document.querySelectorAll(".zbt-path").forEach((e=>{e.classList.remove("_active")})),h.classList.add("_active"));const L=u.getAttribute("data-artefacts-screen");if(L){const y=h.querySelector(`[data-artefacts="${L}"]`);y&&(h.querySelectorAll(".zbt-inventory").forEach((e=>{e.classList.remove("_active")})),y.classList.add("_active"));const E=h.querySelector(".zbt-inventories");E&&E.classList.add("_active")}if(t.offsetWidth<s||0===s){e.setAttribute("data-carousel-active","true"),e.classList.add("carousel-active"),n=v,i=v,r=!0,o.forEach((e=>e.classList.remove("active"))),u.classList.add("active"),l();let _=0,p=0;e.addEventListener("touchstart",(function(e){_=e.changedTouches[0].screenX}),!1),e.addEventListener("touchend",(function(e){p=e.changedTouches[0].screenX,g()}),!1),e.addEventListener("mousedown",(function(e){e.preventDefault(),_=e.screenX,document.addEventListener("mousemove",f),document.addEventListener("mouseup",b)}));let z=0;function f(t){z=t.screenX;const s=z-_,n=e.querySelector(".tilted-card.active");n&&Motion.animate(n,{x:s/5},{duration:0})}function b(t){p=t.screenX,document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",b);const s=e.querySelector(".tilted-card.active");s&&Motion.animate(s,{x:0},{duration:.2}),g()}function g(){p-_>50?(r=!1,d((n-1+c)%c),a="prev"):_-p>50&&(r=!1,d((n+1)%c),a="next")}}else o.forEach((e=>e.classList.remove("active"))),u.classList.add("active")}))}))}))}t(),window.addEventListener("resize",t)})),document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelectorAll(".artifact");0!==e.length&&e.forEach((function(e){const t=e.querySelector(".artifact__tooltip");t&&(e.addEventListener("mouseenter",(function(){t.classList.add("_active");e.getBoundingClientRect().top<350?(t.classList.add("_bottom"),t.classList.remove("_top")):(t.classList.add("_top"),t.classList.remove("_bottom")),requestAnimationFrame((()=>{t.getBoundingClientRect().right-window.innerWidth>20?t.classList.add("_left"):t.classList.remove("_left")}))})),e.addEventListener("mouseleave",(function(){t.classList.remove("_active","_top","_bottom","_left")})))}))}));